// Generated by CIRCT firtool-1.128.0
module Fetch(
  input         clock,
                reset,
                io_axi_ar_ready,
  output        io_axi_ar_valid,
  output [31:0] io_axi_ar_bits_addr,
  output        io_axi_r_ready,
  input         io_axi_r_valid,
  input  [31:0] io_axi_r_bits_data,
  input         io_redirect_valid,
  input  [31:0] io_redirect_bits,
  input         io_out_ready,
  output        io_out_valid,
  output [31:0] io_out_bits_pc,
                io_out_bits_inst,
  output        io_out_bits_isException,
  output [31:0] io_debug_pc
);

  wire        _queue_io_enq_ready;
  reg  [31:0] pc;
  reg         reqSent;
  wire        io_axi_ar_valid_0 = ~reqSent & ~reset;
  always @(posedge clock) begin
    if (reset) begin
      pc <= 32'h80000000;
      reqSent <= 1'h0;
    end
    else begin
      automatic logic _GEN;
      _GEN = io_axi_ar_ready & io_axi_ar_valid_0;
      if (io_redirect_valid)
        pc <= io_redirect_bits;
      else if (_GEN)
        pc <= pc + 32'h4;
      reqSent <=
        ~(_queue_io_enq_ready & io_axi_r_valid | io_redirect_valid) & (_GEN | reqSent);
    end
  end // always @(posedge)
  Queue2_FetchPacket queue (
    .clock                   (clock),
    .reset                   (reset),
    .io_enq_ready            (_queue_io_enq_ready),
    .io_enq_valid            (io_axi_r_valid & ~io_redirect_valid),
    .io_enq_bits_pc          (pc),
    .io_enq_bits_inst        (io_axi_r_bits_data),
    .io_enq_bits_isException (1'h0),
    .io_deq_ready            (io_out_ready),
    .io_deq_valid            (io_out_valid),
    .io_deq_bits_pc          (io_out_bits_pc),
    .io_deq_bits_inst        (io_out_bits_inst),
    .io_deq_bits_isException (io_out_bits_isException)
  );
  assign io_axi_ar_valid = io_axi_ar_valid_0;
  assign io_axi_ar_bits_addr = pc;
  assign io_axi_r_ready = _queue_io_enq_ready;
  assign io_debug_pc = pc;
endmodule

