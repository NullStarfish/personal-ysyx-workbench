// Generated by CIRCT firtool-1.128.0
module Execute(
  input         clock,
                reset,
  output        io_in_ready,
  input         io_in_valid,
  input  [31:0] io_in_bits_pc,
                io_in_bits_rs1Data,
                io_in_bits_rs2Data,
                io_in_bits_imm,
  input  [4:0]  io_in_bits_rdAddr,
                io_in_bits_rs1Addr,
  input  [3:0]  io_in_bits_ctrl_aluOp,
  input  [1:0]  io_in_bits_ctrl_csrOp,
  input         io_in_bits_ctrl_regWen,
                io_in_bits_ctrl_memEn,
                io_in_bits_ctrl_memWen,
  input  [2:0]  io_in_bits_ctrl_memFunct3,
  input         io_in_bits_ctrl_op1Sel,
                io_in_bits_ctrl_op2Sel,
                io_in_bits_ctrl_isJump,
                io_in_bits_ctrl_isBranch,
                io_in_bits_ctrl_isEcall,
                io_in_bits_ctrl_isMret,
                io_in_bits_ctrl_isEbreak,
  input  [11:0] io_in_bits_csrAddr,
  input         io_out_ready,
  output        io_out_valid,
  output [31:0] io_out_bits_aluResult,
                io_out_bits_memWData,
                io_out_bits_pcTarget,
  output [4:0]  io_out_bits_rdAddr,
  output [3:0]  io_out_bits_ctrl_aluOp,
  output [1:0]  io_out_bits_ctrl_csrOp,
  output        io_out_bits_ctrl_regWen,
                io_out_bits_ctrl_memEn,
                io_out_bits_ctrl_memWen,
  output [2:0]  io_out_bits_ctrl_memFunct3,
  output        io_out_bits_ctrl_op1Sel,
                io_out_bits_ctrl_op2Sel,
                io_out_bits_ctrl_isJump,
                io_out_bits_ctrl_isBranch,
                io_out_bits_ctrl_isEcall,
                io_out_bits_ctrl_isMret,
                io_out_bits_ctrl_isEbreak,
                io_out_bits_redirect,
                io_redirect_valid,
  output [31:0] io_redirect_bits
);

  wire [31:0] _csr_io_rdata;
  wire [31:0] _csr_io_evec;
  wire [31:0] _csr_io_epc;
  wire [31:0] _alu_io_out;
  wire        _inQueue_q_io_deq_valid;
  wire [31:0] _inQueue_q_io_deq_bits_pc;
  wire [31:0] _inQueue_q_io_deq_bits_rs1Data;
  wire [31:0] _inQueue_q_io_deq_bits_rs2Data;
  wire [31:0] _inQueue_q_io_deq_bits_imm;
  wire [4:0]  _inQueue_q_io_deq_bits_rs1Addr;
  wire [3:0]  _inQueue_q_io_deq_bits_ctrl_aluOp;
  wire [1:0]  _inQueue_q_io_deq_bits_ctrl_csrOp;
  wire [2:0]  _inQueue_q_io_deq_bits_ctrl_memFunct3;
  wire        _inQueue_q_io_deq_bits_ctrl_op1Sel;
  wire        _inQueue_q_io_deq_bits_ctrl_op2Sel;
  wire        _inQueue_q_io_deq_bits_ctrl_isJump;
  wire        _inQueue_q_io_deq_bits_ctrl_isBranch;
  wire        _inQueue_q_io_deq_bits_ctrl_isEcall;
  wire        _inQueue_q_io_deq_bits_ctrl_isMret;
  wire        _inQueue_q_io_deq_bits_ctrl_isEbreak;
  wire [11:0] _inQueue_q_io_deq_bits_csrAddr;
  wire [31:0] op1 =
    _inQueue_q_io_deq_bits_ctrl_op1Sel
      ? _inQueue_q_io_deq_bits_pc
      : _inQueue_q_io_deq_bits_rs1Data;
  wire        _branchCondition_T_4 =
    _inQueue_q_io_deq_bits_ctrl_memFunct3 == 3'h0
    & _inQueue_q_io_deq_bits_rs1Data == _inQueue_q_io_deq_bits_rs2Data;
  wire [7:0]  _GEN =
    {{_inQueue_q_io_deq_bits_rs1Data >= _inQueue_q_io_deq_bits_rs2Data},
     {_inQueue_q_io_deq_bits_rs1Data < _inQueue_q_io_deq_bits_rs2Data},
     {$signed(_inQueue_q_io_deq_bits_rs1Data) >= $signed(_inQueue_q_io_deq_bits_rs2Data)},
     {$signed(_inQueue_q_io_deq_bits_rs1Data) < $signed(_inQueue_q_io_deq_bits_rs2Data)},
     {_branchCondition_T_4},
     {_branchCondition_T_4},
     {_inQueue_q_io_deq_bits_rs1Data != _inQueue_q_io_deq_bits_rs2Data},
     {_branchCondition_T_4}};
  wire [31:0] finalTarget =
    _inQueue_q_io_deq_bits_ctrl_isMret
      ? _csr_io_epc
      : _inQueue_q_io_deq_bits_ctrl_isEcall
          ? _csr_io_evec
          : _inQueue_q_io_deq_bits_ctrl_isJump & ~_inQueue_q_io_deq_bits_ctrl_op1Sel
              ? _inQueue_q_io_deq_bits_rs1Data + _inQueue_q_io_deq_bits_imm & 32'hFFFFFFFE
              : _inQueue_q_io_deq_bits_pc + _inQueue_q_io_deq_bits_imm;
  wire        isRedirect =
    _inQueue_q_io_deq_bits_ctrl_isBranch & _GEN[_inQueue_q_io_deq_bits_ctrl_memFunct3]
    | _inQueue_q_io_deq_bits_ctrl_isJump | _inQueue_q_io_deq_bits_ctrl_isEcall
    | _inQueue_q_io_deq_bits_ctrl_isMret;
  Queue1_DecodePacket inQueue_q (
    .clock                      (clock),
    .reset                      (reset),
    .io_enq_ready               (io_in_ready),
    .io_enq_valid               (io_in_valid),
    .io_enq_bits_pc             (io_in_bits_pc),
    .io_enq_bits_rs1Data        (io_in_bits_rs1Data),
    .io_enq_bits_rs2Data        (io_in_bits_rs2Data),
    .io_enq_bits_imm            (io_in_bits_imm),
    .io_enq_bits_rdAddr         (io_in_bits_rdAddr),
    .io_enq_bits_rs1Addr        (io_in_bits_rs1Addr),
    .io_enq_bits_ctrl_aluOp     (io_in_bits_ctrl_aluOp),
    .io_enq_bits_ctrl_csrOp     (io_in_bits_ctrl_csrOp),
    .io_enq_bits_ctrl_regWen    (io_in_bits_ctrl_regWen),
    .io_enq_bits_ctrl_memEn     (io_in_bits_ctrl_memEn),
    .io_enq_bits_ctrl_memWen    (io_in_bits_ctrl_memWen),
    .io_enq_bits_ctrl_memFunct3 (io_in_bits_ctrl_memFunct3),
    .io_enq_bits_ctrl_op1Sel    (io_in_bits_ctrl_op1Sel),
    .io_enq_bits_ctrl_op2Sel    (io_in_bits_ctrl_op2Sel),
    .io_enq_bits_ctrl_isJump    (io_in_bits_ctrl_isJump),
    .io_enq_bits_ctrl_isBranch  (io_in_bits_ctrl_isBranch),
    .io_enq_bits_ctrl_isEcall   (io_in_bits_ctrl_isEcall),
    .io_enq_bits_ctrl_isMret    (io_in_bits_ctrl_isMret),
    .io_enq_bits_ctrl_isEbreak  (io_in_bits_ctrl_isEbreak),
    .io_enq_bits_csrAddr        (io_in_bits_csrAddr),
    .io_deq_ready               (io_out_ready),
    .io_deq_valid               (_inQueue_q_io_deq_valid),
    .io_deq_bits_pc             (_inQueue_q_io_deq_bits_pc),
    .io_deq_bits_rs1Data        (_inQueue_q_io_deq_bits_rs1Data),
    .io_deq_bits_rs2Data        (_inQueue_q_io_deq_bits_rs2Data),
    .io_deq_bits_imm            (_inQueue_q_io_deq_bits_imm),
    .io_deq_bits_rdAddr         (io_out_bits_rdAddr),
    .io_deq_bits_rs1Addr        (_inQueue_q_io_deq_bits_rs1Addr),
    .io_deq_bits_ctrl_aluOp     (_inQueue_q_io_deq_bits_ctrl_aluOp),
    .io_deq_bits_ctrl_csrOp     (_inQueue_q_io_deq_bits_ctrl_csrOp),
    .io_deq_bits_ctrl_regWen    (io_out_bits_ctrl_regWen),
    .io_deq_bits_ctrl_memEn     (io_out_bits_ctrl_memEn),
    .io_deq_bits_ctrl_memWen    (io_out_bits_ctrl_memWen),
    .io_deq_bits_ctrl_memFunct3 (_inQueue_q_io_deq_bits_ctrl_memFunct3),
    .io_deq_bits_ctrl_op1Sel    (_inQueue_q_io_deq_bits_ctrl_op1Sel),
    .io_deq_bits_ctrl_op2Sel    (_inQueue_q_io_deq_bits_ctrl_op2Sel),
    .io_deq_bits_ctrl_isJump    (_inQueue_q_io_deq_bits_ctrl_isJump),
    .io_deq_bits_ctrl_isBranch  (_inQueue_q_io_deq_bits_ctrl_isBranch),
    .io_deq_bits_ctrl_isEcall   (_inQueue_q_io_deq_bits_ctrl_isEcall),
    .io_deq_bits_ctrl_isMret    (_inQueue_q_io_deq_bits_ctrl_isMret),
    .io_deq_bits_ctrl_isEbreak  (_inQueue_q_io_deq_bits_ctrl_isEbreak),
    .io_deq_bits_csrAddr        (_inQueue_q_io_deq_bits_csrAddr)
  );
  ALU alu (
    .io_a   (op1),
    .io_b
      (_inQueue_q_io_deq_bits_ctrl_op2Sel
         ? _inQueue_q_io_deq_bits_imm
         : _inQueue_q_io_deq_bits_rs2Data),
    .io_op  (_inQueue_q_io_deq_bits_ctrl_aluOp),
    .io_out (_alu_io_out)
  );
  CSR csr (
    .clock      (clock),
    .reset      (reset),
    .io_cmd     (_inQueue_q_io_deq_bits_ctrl_csrOp),
    .io_addr    (_inQueue_q_io_deq_bits_csrAddr),
    .io_wdata
      (_inQueue_q_io_deq_bits_ctrl_op2Sel
         ? {27'h0, _inQueue_q_io_deq_bits_rs1Addr}
         : op1),
    .io_rdata   (_csr_io_rdata),
    .io_pc      (_inQueue_q_io_deq_bits_pc),
    .io_isEcall (_inQueue_q_io_deq_bits_ctrl_isEcall & _inQueue_q_io_deq_valid),
    .io_isMret  (_inQueue_q_io_deq_bits_ctrl_isMret & _inQueue_q_io_deq_valid),
    .io_evec    (_csr_io_evec),
    .io_epc     (_csr_io_epc)
  );
  SimEbreak simEbreak (
    .valid     (_inQueue_q_io_deq_bits_ctrl_isEbreak & _inQueue_q_io_deq_valid),
    .is_ebreak (32'h0)
  );
  assign io_out_valid = _inQueue_q_io_deq_valid;
  assign io_out_bits_aluResult =
    (|_inQueue_q_io_deq_bits_ctrl_csrOp) ? _csr_io_rdata : _alu_io_out;
  assign io_out_bits_memWData = _inQueue_q_io_deq_bits_rs2Data;
  assign io_out_bits_pcTarget = finalTarget;
  assign io_out_bits_ctrl_aluOp = _inQueue_q_io_deq_bits_ctrl_aluOp;
  assign io_out_bits_ctrl_csrOp = _inQueue_q_io_deq_bits_ctrl_csrOp;
  assign io_out_bits_ctrl_memFunct3 = _inQueue_q_io_deq_bits_ctrl_memFunct3;
  assign io_out_bits_ctrl_op1Sel = _inQueue_q_io_deq_bits_ctrl_op1Sel;
  assign io_out_bits_ctrl_op2Sel = _inQueue_q_io_deq_bits_ctrl_op2Sel;
  assign io_out_bits_ctrl_isJump = _inQueue_q_io_deq_bits_ctrl_isJump;
  assign io_out_bits_ctrl_isBranch = _inQueue_q_io_deq_bits_ctrl_isBranch;
  assign io_out_bits_ctrl_isEcall = _inQueue_q_io_deq_bits_ctrl_isEcall;
  assign io_out_bits_ctrl_isMret = _inQueue_q_io_deq_bits_ctrl_isMret;
  assign io_out_bits_ctrl_isEbreak = _inQueue_q_io_deq_bits_ctrl_isEbreak;
  assign io_out_bits_redirect = isRedirect;
  assign io_redirect_valid = isRedirect & _inQueue_q_io_deq_valid;
  assign io_redirect_bits = finalTarget;
endmodule

